(function(t){function e(e){for(var i,c,r=e[0],o=e[1],l=e[2],u=0,f=[];u<r.length;u++)c=r[u],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&f.push(a[c][0]),a[c]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);v&&v(e);while(f.length)f.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,r=1;r<s.length;r++){var o=s[r];0!==a[o]&&(i=!1)}i&&(n.splice(e--,1),t=c(c.s=s[0]))}return t}var i={},a={app:0},n=[];function c(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.m=t,c.c=i,c.d=function(t,e,s){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)c.d(s,i,function(e){return t[e]}.bind(null,i));return s},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var v=o;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";s("85ec")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i,a,n=s("2b0e"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"desc"},[s("el-button",{on:{click:t.storageSave}},[t._v("Записать")]),s("el-button",{on:{click:t.storageClear}},[t._v("Стереть")])],1),s("div",{staticClass:"desc"},[t._v("общие тр-ты:")]),s("div",{staticClass:"value"},[t._v(t._s(t.tasksCount))]),s("div",{staticClass:"desc"},[t._v("разработчик:")]),s("div",{staticStyle:{flex:"1 0"}},[s("el-input",{model:{value:t.cMember.name,callback:function(e){t.$set(t.cMember,"name",e)},expression:"cMember.name"}})],1),s("div",{staticClass:"desc"},[s("el-popconfirm",{attrs:{title:"Удалить?"},on:{confirm:t.onDel}},[s("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("Удалить")])],1)],1),s("div",{staticClass:"desc"},[s("el-button",{on:{click:t.onAdd}},[t._v("+")])],1)]),s("hr"),s("div",{staticClass:"row"},[s("div"),s("div",{staticClass:"desc"},[t._v("задача:")]),s("div",{staticStyle:{flex:"1 0"}},[s("el-input",{model:{value:t.cTask.name,callback:function(e){t.$set(t.cTask,"name",e)},expression:"cTask.name"}})],1),s("div",{staticClass:"desc"},[t._v("дней:")]),s("div",{staticStyle:{width:"100px"}},[s("el-input",{model:{value:t.cTask.time,callback:function(e){t.$set(t.cTask,"time",e)},expression:"cTask.time"}})],1),s("div",{staticClass:"desc"},[t._v("тип:")]),s("div",{staticStyle:{width:"150px"}},[s("el-select",{attrs:{placeholder:"Select"},model:{value:t.cTask.typeId,callback:function(e){t.$set(t.cTask,"typeId",e)},expression:"cTask.typeId"}},t._l(t.types,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("div",[s("el-popconfirm",{attrs:{title:"Удалить?"},on:{confirm:t.onDelTask}},[s("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("Удалить")])],1)],1),s("div",[s("el-button",{on:{click:t.onMove}},[t._v("Переместить")])],1)]),s("hr"),t._m(0),t._l(t.members,(function(e){return s("div",{key:e.id,staticClass:"member",class:{active:e.isActive},on:{click:function(s){return t.onSelect(e)}}},[s("div",{staticClass:"nm"},[t._v(t._s(e.name))]),s("div",{staticClass:"tasks"},t._l(e.tasks,(function(i){return s("div",{key:i.id,staticClass:"task",class:{prev:i.isPrev,active:i.isActive,w2:2==i.time,w3:3==i.time,w4:4==i.time,w5:5==i.time,w6:6==i.time,w7:7==i.time,w8:8==i.time,w9:9==i.time,w10:10==i.time}},[s("div",{staticClass:"task-space",class:{active:t.isMoving},on:{click:function(s){return t.onMoved(i,e)}}},[t._v("   ")]),s("div",{staticClass:"task-name",on:{click:function(e){return t.onSelectTask(i)},mouseover:function(e){return t.notify("Задача","Можно сделать текущей - клик","th")}}},[s("strong",[t._v(t._s(t.parseType(i.typeId)))]),t._v(" "+t._s(i.name)+" ")])])})),0),s("div",{staticClass:"add-button"},[e.isActive?s("el-button",{on:{click:t.onAddTask}},[t._v("+")]):t._e()],1)])})),s("div",{staticClass:"space"}),s("div",{staticStyle:{display:"flex"}},[t._m(1),s("div",{staticClass:"persent"},[t._l(t.types,(function(e){return s("p",{key:e.value},[s("strong",[t._v(t._s(e.sn))]),t._v(" "+t._s(e.label)+" : "+t._s(t.typesCount[e.value])+" % ")])})),s("p",[t._v("не указано: "+t._s(t.typesCount[0])+" %")])],2)]),s("div",{staticClass:"debug"},[s("p",[t._v(t._s(t.members))]),s("p",[t._v(t._s(t.fire))]),s("hr"),s("p",[t._v(t._s(t.pTask))]),s("hr"),s("p",[t._v(t._s(t.cTask))])])],2)},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"member"},[s("div",{staticClass:"nm"}),s("div",{staticClass:"tasks"},[s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("1")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("2")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("3")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("4")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("5")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("6")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("7")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("8")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("9")])]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-space"},[t._v(" ")]),s("div",{staticClass:"task-name"},[t._v("10")])])]),s("div",{staticClass:"add-button"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("canvas",{attrs:{id:"fire",width:"500",height:"500"}})])}],o=(s("159b"),s("c35a"),s("a9e3"),s("25eb"),s("b0c0"),s("4de4"),s("a434"),s("d3b7"),s("25f0"),{name:"app",components:{},data:function(){return{members:[{id:.11482149135454323,name:"Максим",tasks:[{id:.0023599485286690536,name:"м1",time:"5",isActive:!0,typeId:2,startDay:0,fireDay:5,fs:0,fe:5},{id:.37211958881958207,name:"м2",time:"5",isActive:!1,typeId:4,startDay:5,fireDay:10,fs:0,fe:5}],isActive:!0},{id:.29428513232894016,name:"Катя",tasks:[{id:.9271747778856098,name:"к1",time:"5",isActive:!1,startDay:0,fireDay:5,fs:5,fe:10,typeId:1},{id:.2861063346717799,name:"к2",time:"5",isActive:!1,startDay:5,fireDay:10,fs:5,fe:10,typeId:3}],isActive:!1}],inMember:"inMember",cMember:{id:1,name:"",tasks:[]},tasks:[],cTask:{},pTask:{},types:[{label:"тех.долг",value:1,sn:"Т"},{label:"нов.фун.",value:2,sn:"Н"},{label:"арх.",value:3,sn:"А"},{label:"дефект",value:4,sn:"Д"}],isMoving:!1,notifyTimer:{}}},mounted:function(){var t=this;i=document.getElementById("fire"),a=i.getContext("2d"),this.storageLoad();var e=null;this.members.forEach((function(s){s.tasks.forEach((function(s){s.isActive&&(e=s,t.onSelectTask(e))}))})),setTimeout((function(){t.pic(t.fire)}),200)},computed:{typesCount:function(){var t={0:0,1:0,2:0,3:0,4:0};this.members.forEach((function(e){e.tasks.forEach((function(e){var s=e.typeId;s?t[s]=Number.parseFloat(t[s])+Number.parseInt(e.time):t[0]=Number.parseFloat(t[0])+Number.parseInt(e.time)}))}));for(var e=0;e<5;e++)t[e]=Math.round(100*t[e]/this.tasksCount);return t},tasksCount:function(){var t=0;return this.members.forEach((function(e){e.tasks.forEach((function(e){t=Number.parseInt(t)+Number.parseInt(e.time)}))})),t},kH:function(){return 500/this.tasksCount},kW:function(){return 50},fire:function(){var t={};return this.setTaskDays(),this.members.forEach((function(e){e.tasks.forEach((function(e){var s=e.fireDay;void 0==t[s]&&(t[s]=0),e.fs=t[s],t[s]=t[s]+Number.parseInt(e.time),e.fe=t[s]}))})),this.pic(t),t}},methods:{setTaskDays:function(){this.members.forEach((function(t){var e=0;t.tasks.forEach((function(t){t.startDay=e,t.fireDay=e+Number.parseInt(t.time),e=t.fireDay}))}))},notify:function(t,e,s){this.notifyTimer[s]&&Date.now()-this.notifyTimer[s]<5e3||(this.notifyTimer[s]=Date.now(),this.$notify({title:t,message:e,position:"bottom-right"}))},changeTasks:function(t,e){var s=t.name,i=e.name,a=t.typeId,n=e.typeId;t.name=i,t.typeId=n,e.name=s,e.typeId=a},checkMemberOverload:function(t){var e=0;return t.tasks.forEach((function(t){e+=Number.parseInt(t.time)})),e-10>0},repareTime:function(t){var e=this;t.tasks.forEach((function(s){e.checkMemberOverload(t)&&(s.time=1)}))},parseType:function(t){if(t){var e=this.types.filter((function(e){return e.value==t}));if(e&&e.length>0)return e[0].sn}return null},onMoved:function(t,e){if(this.isMoving){var s=this.cMember.tasks.indexOf(this.cTask);this.cMember.tasks.splice(s,1);var i=e.tasks.indexOf(t);e.tasks.splice(i,0,this.cTask),this.isMoving=!1,this.checkMemberOverload(e)&&(this.cTask.time=1),this.checkMemberOverload(e)&&(t.time=1),this.repareTime(e)}},onMove:function(){this.isMoving=!0,this.notify("Перемещение задачи","Зелеными маркерами подсвечены возможные места перемещения","tm")},storageClear:function(){window.localStorage.removeItem("dt"),window.location.reload()},storageSave:function(){window.localStorage.setItem("dt",JSON.stringify(this.members))},storageLoad:function(){var t=this,e=window.localStorage.getItem("dt");e?this.members=JSON.parse(e):setTimeout((function(){t.notify("нет данных","загружены демонстрационные данные","dt"),t.storageSave(),t.storageLoad()}),500)},pic:function(t){if(a){a.font="12px serif",a.clearRect(0,0,500,500),a.beginPath(),a.moveTo(1,1);for(var e=0,s=0,i=0;i<11;i++)t[i.toString()]&&(e+=t[i.toString()],this.cTask.fireDay==i&&(s=e)),a.lineTo(i*this.kW,e*this.kH);a.strokeStyle="#000",a.stroke(),a.closePath(),a.beginPath();for(var n=0;n<10;n++)a.moveTo(50*n,1),a.lineTo(50*n,500),a.fillStyle="rgba(0,0,0,0.9)",a.fillText(n+1,50*(n+1)-12,10);for(var c=500/this.tasksCount,r=0;r<this.tasksCount;r++)a.moveTo(1,r*this.kH),a.lineTo(500,r*this.kH),a.fillText(r+1,5,(r+1)*c);a.strokeStyle="rgba(0, 0, 0, 0.1)",a.stroke(),a.fillStyle="rgba(0,255,0,0.1)",a.fillRect(50*this.cTask.startDay,1,50*this.cTask.time,500),a.fillRect(0,(s-t[this.cTask.fireDay]+this.cTask.fs)*this.kH,500,this.cTask.time*this.kH)}},onSave:function(){},onDel:function(){var t=this.members.indexOf(this.cMember);this.members.splice(t,1),this.cMember={},this.cTask={}},onDelTask:function(){var t,e=this,s=0;this.cMember.tasks.forEach((function(i){i.id==e.cTask.id&&(t=s),s++})),console.log("indexToDel",t),this.cMember.tasks.splice(t,1),this.cTask={}},onAdd:function(){var t={id:null,name:"новый участник",tasks:[],isActive:!1};this.members.push(t),t.id=Math.random()},onSelect:function(t){this.cMember=t,this.clearMembersIsActive(),t.isActive=!0},onAddTask:function(){var t=this,e={id:Math.random(),name:"новая задача",time:1,isActive:!1,typeId:2};t.cMember.tasks.push(e),t.checkMemberOverload(t.cMember)&&t.repareTime(t.cMember)},clearMembersIsActive:function(){this.members.forEach((function(t){t.isActive=!1}))},onSelectTask:function(t){this.isMoving?this.changeTasks(this.cTask,t):(this.cTask=t,this.notify("Выбор задачи","Выбранную задачу можно отредактировать, обменять с другой задачей или переместить","ta")),this.members.forEach((function(t){t.tasks.forEach((function(t){t.isActive=!1}))})),t.isActive=!0,this.isMoving=!1,this.setTaskDays();this.fire}}}),l=o,v=(s("034f"),s("2877")),u=Object(v["a"])(l,c,r,!1,null,null,null),f=u.exports,d=s("5c96"),m=s.n(d),k=(s("0fae"),s("dccd")),p=s.n(k);n["default"].use(m.a,{locale:p.a}),n["default"].config.productionTip=!1,new n["default"]({render:function(t){return t(f)}}).$mount("#app")},"85ec":function(t,e,s){}});
//# sourceMappingURL=app.faec70b8.js.map